Input" style="display:none" onchange="handleFileUpload()"/>
    <button class="button" onclick="goBack()">戻る</button>
  </div>

  <!-- ✅ ミッション完了ページ -->
  <div class="container" id="completed-missions" style="display:none;">
    <h1 class="box">COMPLETED MISSIONS</h1>
    <div id="completed-mission-list"></div>
    <button class="button" onclick="goBack()">戻る</button>
  </div>

  <script>
    let totalPoints = parseInt(localStorage.getItem('totalPoints') || '0', 10);
    document.getElementById('total-points').textContent = totalPoints;

    function getMissionPoints(id) {
      return id === 18 ? 40 : id <= 6 ? 3 : id <= 12 ? 5 : 10;
    }

    function populateMissions() {
      let missionList = '';
      for (let i = 1; i <= 6; i++) {
        missionList += `<tr>
          <td><a id="mission${i}" onclick="showMission(${i})">MISSION ${i}</a></td>
          <td><a id="mission${i+6}" onclick="showMission(${i+6})">MISSION ${i+6}</a></td>
          <td><a id="mission${i+12}" onclick="showMission(${i+12})">MISSION ${i+12}</a></td>
        </tr>`;
      }
      document.getElementById('mission-list').innerHTML = missionList;
      for (let i = 1; i <= 18; i++) {
        if (localStorage.getItem(`MISSION_${i}`)) document.getElementById(`mission${i}`).classList.add('completed');
      }
    }

    function showMission(id) {
      document.getElementById('mission-id').textContent = id;
      document.getElementById('mission-description').textContent = `沖縄に生息する◯◯を発見せよ`;
      document.getElementById('mission-points').textContent = getMissionPoints(id);
      document.getElementById('mission-info').textContent = "ここにミッションに関する詳細情報を記載する";
      
      document.getElementById('main-page').style.display = 'none';
      document.getElementById('mission-details').style.display = 'block';
    }

    function handleFileUpload() {
      const fileInput = document.getElementById('fileInput');
      const missionId = document.getElementById('mission-id').textContent;
      if (fileInput.files.length === 0 || localStorage.getItem(`MISSION_${missionId}`)) return alert('Mission already completed.');
      
      localStorage.setItem(`MISSION_${missionId}`, "completed");
      document.getElementById(`mission${missionId}`).classList.add('completed');
      
      totalPoints += getMissionPoints(missionId);
      localStorage.setItem('totalPoints', totalPoints);
      document.getElementById('total-points').textContent = totalPoints;
      
      alert(`証拠写真が提出されました (MISSION ${missionId})`);
    }

    function showCompletedMissions() {
      document.getElementById('main-page').style.display = 'none';
      document.getElementById('completed-missions').style.display = 'block';
      
      let completedHTML = "";
      for (let i = 1; i <= 18; i++) {
        if (localStorage.getItem(`MISSION_${i}`)) {
          completedHTML += `<div class="box"><h2>MISSION ${i}</h2><p>Completed</p></div>`;
        }
      }
      document.getElementById('completed-mission-list').innerHTML = completedHTML;
    }

    function goBack() {
      document.getElementById('main-page').style.display = 'block';
      document.getElementById('mission-details').style.display = 'none';
      document.getElementById('completed-missions').style.display = 'none';
    }

    function resetAllData() {
      if (!confirm('すべてのデータを削除します。よろしいですか？')) return;
      
      for (let i = 1; i <= 18; i++) {
        localStorage.removeItem(`MISSION_${i}`);
      }
      localStorage.setItem('totalPoints', '0');
      totalPoints = 0;
      document.getElementById('total-points').textContent = '0';
      populateMissions();
      alert('すべてのデータを削除しました。');
    }

    populateMissions();
  </script>

</body>
</html>
